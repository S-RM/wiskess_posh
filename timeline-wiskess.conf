input {
  file{
    path => ["/mnt/x/*/Analysis/Timeline/*.json"]
	start_position => "beginning"
	sincedb_path => "/dev/null"
	codec => "json"
	file_completed_action => "log"
	file_completed_log_path => "/root/logstash/ingest.log"
	mode => "read"
  }
}

filter {
	date {
	  match => ["datetime", "yyyy-MM-dd HH:mm:ss", "yyyy-MM-dd'T'HH:mm:ss.SSS","ISO8601","yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","yyyy-MM-dd HH:mm:ss.SSS"]  # 2023-05-01T00:00:01.001 Adjust this to match your datetime format
	  target => "@timestamp"
	}
	json {
		source => "message"
	}
	fingerprint
	{
		source => [ "message" ]
		concatenate_sources => true
		method => "MD5"
		key => "fingerprint"
		base64encode => true
		target => "[@metadata][fingerprint]"
	}
}
output {
  elasticsearch {
    hosts => "xxxxxxxxxxxx" # update the elastic url
	document_id => "%{[@metadata][fingerprint]}"
    user => "elastic"
    password => "xxxxxxxxxxxxxxx" # update the password
    index => "casename-wiskess" # update the casename
  }
}